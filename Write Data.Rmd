---
title: "Write Data"
author: "Nicole"
date: "10/16/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
accidents <- read_csv("/Users/nicolehiggins/Documents/Macalester/Machine Learning/Project/US_Accidents_Dec20_updated.csv")

accident_clean <- accidents %>%
    filter(year(Start_Time) >= 2018, year(Start_Time) <= 2019) %>%
    drop_na(.) %>%
    select(-End_Time, -Airport_Code, -Timezone, -Weather_Timestamp, -Civil_Twilight, -Nautical_Twilight,-Astronomical_Twilight, -Traffic_Calming, -`Humidity(%)`, -`Wind_Chill(F)`, -Railway,  -Bump, -Amenity, -Country, -`Pressure(in)`, -Wind_Direction, -Give_Way, -No_Exit, -Roundabout, - Station, -Stop, -Turning_Loop, - Stop, -Description, - Street, -Severity) %>%
  sample_frac(size = 1/5) %>%
  mutate(Crossing = if_else(Crossing, 1, 0)) %>%
  mutate(Traffic_Signal = if_else(Traffic_Signal, 1, 0)) %>%
  mutate(logDist = log(`Distance(mi)`+.1)) %>%
  select(-`Distance(mi)`)

write_csv(accident_sub, 'accident_clean.csv')
```

